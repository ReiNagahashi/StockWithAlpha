<!DOCTYPE html>

<html>
    <head>
        <meta charset="UTF-8">
        <title>Chart</title>
        <style>
            #dashboard_div{
                width: 600px;
                border: 1px solid #ccc;
            }
            #chart_div{
                height:400px;
                border-bottom: 1px solid #ccc;
            }
            #filter_div{
                height:50px;
            }
            .technical_title{
                margin: 10px;
                color: gray;
            }
            .bottom_chart{
                border-bottom: 1px solid #ccc;
            }
            
        /* ãƒ¢ãƒ¼ãƒ€ãƒ«ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã®ã‚¹ã‚¿ã‚¤ãƒ« */
        .modal {
            display: none; /* æœ€åˆã¯éè¡¨ç¤º */
            position: fixed;
            z-index: 1;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            overflow: auto;
            background-color: rgba(0,0,0,0.4);
        }

        .modal-content {
            background-color: #fefefe;
            margin: 15% auto;
            padding: 20px;
            border: 1px solid #888;
            width: 80%;
        }

        .close {
            color: #aaa;
            float: right;
            font-size: 28px;
            font-weight: bold;
        }

        .close:hover,
        .close:focus {
            color: black;
            text-decoration: none;
            cursor: pointer;
        }
        </style>
        <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
        <script type="text/javascript">
            google.charts.load('current', {'packages':['corechart', 'controls']});
            var config = {
                // Ajaxã‚’ä½¿ã£ã¦ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã«ãƒšãƒ¼ã‚¸ã‚’æ›´æ–°ã—ãŸã„ã¨ãã«ä½¿ç”¨
                //api:{
                 //   enable: true,
                 //  interval: 1000*3
              //  },
                candlestick:{
                    symbol: 'IBM',
                    duration: '',
                    limit: 365,
                    //ã‚«ãƒ©ãƒ æ•°ã¯ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§ï¼•ã¨ã—ã¦ãŠãã€‚ãã“ã«ä»˜ã‘è¶³ã—ã¦ã„ãæ„Ÿã˜
                    numViews: 5,
                },
                dataTable: {
                    index: 0,
                    value: null
                },
                sma: {
                    enable: false,
                    indices: [],
                    periods: [],
                    values: []
                },
                ema:{
                    enable: false,
                    indices: [],
                    periods: [],
                    values: []
                },
                bbands: {
                    enable:false,
                    indices: [],
                    n: 20,
                    k: 2,
                    up: [],
                    mid: [],
                    down: []
                },
                volume: {
                    enable: false,
                    index: [],
                    values: []
                },
                rsi: {
                    enable: false,
                    indices: {'up': 0, 'value': 0, 'down': 0},
                    period: 14,
                    up: 70,
                    values: [],
                    down: 30
                },
                events: {
                    enable: false,
                    indices: [],
                    values: [],
                    first: null
                },
                tickersBySearch: {
                    tickers: []
                }
            };
            //sendã§ãƒ‡ãƒ¼ã‚¿ã‚’å–ã£ã¦ãã¦å†æç”»ã™ã‚‹ãŸã‚ã«å„ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’åˆæœŸåŒ–ã™ã‚‹
            function initConfigValues(){
                config.dataTable.index = 0;
                config.sma.indices = [];
                config.sma.values = [];
                config.ema.indices = [];
                config.ema.values = [];
                config.bbands.indices = [];
                config.bbands.up = [];
                config.bbands.mid = [];
                config.bbands.down = [];
                config.volume.index = [];
                config.rsi.indices = [];
                config.events.indices = [];
                config.events.values = [];
            }


            function drawChart(dataTable){
                var chartDiv = document.getElementById('chart_div');
                var charts = [];
                var dashboard = new google.visualization.Dashboard(chartDiv);
                var mainChart = new google.visualization.ChartWrapper({
                    chartType: 'ComboChart',
                    containerId: 'chart_div',
                    options:{
                        hAxis: {'slantedText': false},
                        legend: {'position': 'none'},
                        candlestick:{
                            fallingColor: { strokeWidth: 0, fill: '#a52714'},
                            risingColor: {strockeWidth: 0, fill: '#0f9d58'}
                        },
                        seriesType: 'candlesticks',
                        series: {}
                    },
                    view :{
                        columns: [
                            {
                                calc: function(d, rowIndex){
                                    return d.getFormattedValue(rowIndex, 0);
                                },
                                type: 'string'
                            }, 1, 2, 3, 4
                        ]
                    }
                });
                charts.push(mainChart);

                var options = mainChart.getOptions();
                var view = mainChart.getView();

                if(config.sma.enable){
                    for(i = 0; i < config.sma.indices.length; i++){
                        //æ—¢ã«ã‚ã‚‹ãƒãƒ£ãƒ¼ãƒˆä¸Šã«smaãƒ‡ãƒ¼ã‚¿ã‚’ãƒ©ã‚¤ãƒ³ã‚¿ã‚¤ãƒ—ã§é‡ã­ã‚‹â†’viewã®ã‚«ãƒ©ãƒ ã«ãƒ—ãƒƒã‚·ãƒ¥ã™ã‚‹ã“ã¨ã§å®Ÿç¾ã§ãã‚‹
                        //å„ãƒãƒ£ãƒ¼ãƒˆä¸Šã®ãƒ‡ãƒ¼ã‚¿ã¯dataTableã®ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã§ç®¡ç†ã•ã‚Œã‚‹
                        options.series[config.sma.indices[i]] = {type: "line"};
                        view.columns.push(config.candlestick.numViews + config.sma.indices[i]);
                    }
                }

                if(config.ema.enable){
                    for(i = 0; i < config.ema.indices.length; i++){
                        options.series[config.ema.indices[i]] = {type: "line"};
                        view.columns.push(config.candlestick.numViews + config.ema.indices[i]);
                    }
                }

                if(config.bbands.enable){
                    for(i = 0; i < config.bbands.indices.length; i++){
                        options.series[config.bbands.indices[i]] = {
                            type: 'line',
                            color: 'blue',
                            lineWidth: 1
                        };

                        view.columns.push(config.candlestick.numViews + config.bbands.indices[i])
                    }
                }

                if (config.events.enable == true && config.events.indices.length > 0){
                    options.series[config.events.indices[0]] = {
                        'type': 'line',
                        tooltip: 'none',
                        enableInteractivity: false,
                        lineWidth: 0
                    };
                    view.columns.push(config.candlestick.numViews + config.events.indices[0]);
                    view.columns.push(config.candlestick.numViews + config.events.indices[1]);
            }

                if(config.volume.enable){
                    if ($('#volume_div').length == 0) {
                        $('#technical_div').append(
                            "<div id='volume_div' class='bottom_chart'>" +
                            "<span class='technical_title'>Volume</span>" +
                            "<div id='volume_chart'></div>" +
                            "</div>")
                    }
                    var volumeChart = new google.visualization.ChartWrapper({
                        'chartType': 'ColumnChart',
                        'containerId': 'volume_chart',
                        'options': {
                            'hAxis': {'slantedText': false},
                            'legend': {'position': 'none'},
                            'series': {}
                        },
                        'view': {
                            'columns': [ { 'type': 'string' }, 5]
                        }
                    });

                    charts.push(volumeChart);
                }

                if (config.rsi.enable == true) {
                if ($('#rsi_div').length == 0) {
                    $('#technical_div').append(
                            "<div id='rsi_div' class='bottom_chart'>" +
                            "<span class='technical_title'>RSI</span>" +
                            "<div id='rsi_chart'></div>" +
                            "</div>")
                }
                var up = config.candlestick.numViews + config.rsi.indices['up'];
                var value = config.candlestick.numViews + config.rsi.indices['value'];
                var down = config.candlestick.numViews + config.rsi.indices['down'];
                var rsiChart = new google.visualization.ChartWrapper({
                    'chartType': 'LineChart',
                    'containerId': 'rsi_chart',
                    'options': {
                        'hAxis': {'slantedText': false},
                        'legend': {'position': 'none'},
                        'series': {
                            0: {color: 'black', lineWidth: 1},
                            1: {color: '#e2431e'},
                            2: {color: 'black', lineWidth: 1}
                        }
                    },
                    'view': {
                        'columns': [ { 'type': 'string' }, up, value, down]
                    }
                });
                charts.push(rsiChart)
            }


                var controlWrapper = new google.visualization.ControlWrapper({
                    'controlType': 'ChartRangeFilter',
                    'containerId': 'filter_div',
                    'options': {
                        'filterColumnIndex': 0,
                        'ui': {
                            'chartType': 'LineChart',
                            'chartView': {
                                'columns': [0, 4]
                            }
                        }
                    }
                });

                dashboard.bind(controlWrapper, charts);
                dashboard.draw(dataTable)
            }
            //ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ãŒãƒ•ã‚©ãƒ¼ãƒ ã«å…¥åŠ›ã•ã‚ŒãŸã‚‰å€™è£œã¨ãªã‚‹ãƒ†ã‚£ãƒƒã‚«ãƒ¼ã‚’ãƒªã‚¹ãƒˆã¨ã—ã¦è¡¨ç¤º
            function sendTickerKeyword(keyword){
                var param = {"keyword": keyword};
                const ul = document.getElementById("ticker_list");

                $.get("/api/ticker_search/", param).done(function(data){
                    config.tickersBySearch = data["bestMatches"];

                    config.tickersBySearch.forEach((ticker, i) => {
                        const li = document.createElement("li");
                        li.innerHTML = `${ticker["2. name"]}(Ticker Code: ${ticker["1. symbol"]}) <button class="open-modal" data-index = ${i}>Click Me</button>`;

                        ul.appendChild(li);
                    });

                })
            }


            function getTicker(symbol){
                console.log("YAYYY")
                config.candlestick.symbol = symbol;
                $.get("/api/ingestion_candle/", {'symbol':symbol}).done(function(data){
                    sendCandleData();
                    console.log(`${symbol} data successfully inserted!!`);
                })
            }


            //ã‚­ãƒ£ãƒ³ãƒ‰ãƒ«ãƒ‡ãƒ¼ã‚¿ã‚’ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã‹ã‚‰å–ã£ã¦ãã¦ãã‚Œã‚’æç”»ã™ã‚‹é–¢æ•°ã‚’å®Ÿè¡Œ
            function sendCandleData(){
                // enableãŒfalseã®å ´åˆã¯AJAXãŒãƒ‡ãƒ¼ã‚¿ã‚’å–ã£ã¦ã“ãªã„ã‚ˆã†ã«ã™ã‚‹
                //if(!config.api.enable) return
                //ä»¥ä¸‹ã§è¾æ›¸paramsã«ä»»æ„ã®ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‚’è¨­å®šã—ã¦ã‚ã’ã‚‹
                //â†’ãã®ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‚’ã‚‚ã¨ã«ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ãŒrequestãƒã‚¤ãƒ³ã‚¿ã‚’é€šã˜ã¦ãƒ‡ãƒ¼ã‚¿ã‚’å–ã£ã¦ãã‚‹
                var params = {
                    "symbol": config.candlestick.symbol,
                    "limit": config.candlestick.limit,
                    "duration": config.candlestick.duration,
                }

                if(config.sma.enable){
                    params["sma"] = true;
                    params["smaPeriod1"] = config.sma.periods[0];
                    params["smaPeriod2"] = config.sma.periods[1];
                    params["smaPeriod3"] = config.sma.periods[2];
                }

                if(config.ema.enable){
                    params["ema"] = true;
                    params["emaPeriod1"] = config.ema.periods[0];
                    params["emaPeriod2"] = config.ema.periods[1];
                    params["emaPeriod3"] = config.ema.periods[2];
                }

                if(config.bbands.enable){
                    params["bbands"] = true;
                    params["bbandsN"] = config.bbands.n;
                    params["bbandsK"] = config.bbands.k;
                }
                if(config.rsi.enable){
                    params["rsi"] = true;
                    params["rsiPeriod"] = config.rsi.period;
                }
                if(config.events.enable){
                    params["events"] = true;
                }
                $.get("/api/candle/", params).done(function(data){
                    initConfigValues();
                    var dataTable = new google.visualization.DataTable();
                    dataTable.addColumn('date', 'Date');
                    dataTable.addColumn('number', 'Low');
                    dataTable.addColumn('number', 'Open');
                    dataTable.addColumn('number', 'Close');
                    dataTable.addColumn('number', 'High');
                    dataTable.addColumn('number', 'Volume');
                    //ãƒ‡ãƒ¼ã‚¿ãƒ†ãƒ¼ãƒ–ãƒ«ã«å€¤ã‚’æ›¸ãè¾¼ã‚“ã§ã„ã dataã¯æ§‹é€ ä½“ã®jsonç”¨è¨˜è¿°ã®ã¨ã“ã‚ã‚’å‚ç…§ã—ã¦ã„ã‚‹
                    if(data["smas"] != undefined){
                        for(i = 0; i < data["smas"].length; i++){
                            var smaData = data["smas"][i];
                            if(smaData.length == 0) continue;
                            //smaç”¨ã«æ–°ãŸã«ãƒãƒ£ãƒ¼ãƒˆã«è¡¨ç¤ºã•ã›ã‚‹ãŸã‚ã®ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã‚’ç”¨æ„ã™ã‚‹ãŸã‚ã«ã€indexã‚’ã‚¤ãƒ³ã‚¯ãƒªãƒ¡ãƒ³ãƒˆ
                            config.dataTable.index++;
                            config.sma.indices[i] = config.dataTable.index;
                            dataTable.addColumn("number", "SMA" + smaData["period"].toString());
                            config.sma.values[i] = smaData["values"];
                        }
                    }

                    if(data["emas"] != undefined){
                        for(i = 0; i < data["emas"].length; i++){
                            var emaData = data["emas"][i];

                            if(emaData.length == 0) continue;
                            config.dataTable.index++;
                            config.ema.indices[i] = config.dataTable.index;
                            dataTable.addColumn("number", "EMA" + emaData["period"].toString());
                            config.ema.values[i] = emaData["values"];
                        }
                    }

                    if(data["bbands"] != undefined){
                        var n = data["bbands"]["n"];
                        var k = data["bbands"]["k"];
                        var up = data["bbands"]["up"];
                        var mid = data["bbands"]["mid"];
                        var down = data["bbands"]["down"];
                        config.dataTable.index++;
                        config.bbands.indices[0] = config.dataTable.index;
                        config.dataTable.index++;
                        config.bbands.indices[1] = config.dataTable.index;
                        config.dataTable.index++;
                        config.bbands.indices[2] = config.dataTable.index;
                        
                        dataTable.addColumn('number', 'BBands Up(' + n + ', ' + k + ')');
                        dataTable.addColumn('number', 'BBands Mid(' + n + ', ' + k + ')');
                        dataTable.addColumn('number', 'BBands Down(' + n + ', ' + k + ')');
                        
                        config.bbands.up = up;
                        config.bbands.mid = mid;
                        config.bbands.down = down;
                    }

                    if (data['events'] != undefined && data['events']['signals'] != undefined) {
                        config.dataTable.index += 1;
                        config.events.indices[0] = config.dataTable.index;
                        config.dataTable.index += 1;
                        config.events.indices[1] = config.dataTable.index;

                        config.events.values = data['events']['signals'];

                        config.events.first = config.events.values.shift();

                        dataTable.addColumn('number', 'Marker');
                        dataTable.addColumn({type:'string', role:'annotation'});

                        if (data['events']['profit'] != undefined) {
                            profit = "$" + String(Math.round(data['events']['profit'] * 100) / 100);
                            $('#profit').html("Change:" + profit);
                        }
                    }
                    
                    if (data['rsi'] != undefined ){
                    config.dataTable.index += 1;
                    config.rsi.indices['up'] = config.dataTable.index;
                    config.dataTable.index += 1;
                    config.rsi.indices['value'] = config.dataTable.index;
                    config.dataTable.index += 1;
                    config.rsi.indices['down'] = config.dataTable.index;
                    config.rsi.period = data['rsi']['period'];
                    config.rsi.values = data['rsi']['values'];
                    dataTable.addColumn('number', 'RSI Thread');
                    dataTable.addColumn('number', 'RSI(' + config.rsi.period + ')');
                    dataTable.addColumn('number', 'RSI Thread');
                }
                    var googleChartData = [];
                    var candles = data["candles"];

                    for(var i = 0; i < candles.length; i++){
                        var candle = candles[i];
                        var date = new Date(candle.date_time);
                        //ğŸš¨dataã¯ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã«ç™»éŒ²ã—ã¦ã‚ã‚‹å„ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰å
                        //ä¸€æ–¹ã§datasã¯ãƒãƒ£ãƒ¼ãƒˆã§è¡¨ç¤ºã•ã›ç”¨ã¨ã—ã¦ã„ã‚‹å„ãƒ‡ãƒ¼ã‚¿ã‚’æŒã¤ãƒªã‚¹ãƒˆã€‚
                        //ã“ã‚Œã‚’dataTable.indexã®å€¤ã‚’ã‚‚ã¤configã®å„ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã®indicesã«æ ¼ç´ã—ã¦ã„ã‚‹. 
                        var datas = [date, candle.low, candle.open, candle.close, candle.high, candle.volume];

                        //ä»¥ä¸‹ã®å„ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã¯enableãŒtrueã«ãªã£ãŸã¨ãã«datasã«å„ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‚’ãƒ—ãƒƒã‚·ãƒ¥ã™ã‚‹
                        //ãã®ä¸Šã§ã€ãã®ãƒ—ãƒƒã‚·ãƒ¥ã•ã‚ŒãŸå„ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‚’æç”»ã™ã‚‹ãŸã‚ã«dataTable.indexã‚’å‚ç…§ã—ã¦ã„ã‚‹
                        if(data["smas"] != undefined){
                            for(var j = 0; j < config.sma.values.length; j++){
                                if(config.sma.values[j][i] == 0){
                                    datas.push(null);
                                }else{
                                    datas.push(config.sma.values[j][i]);
                                }
                            }
                        }

                        if(data["emas"] != undefined){
                            for(j = 0; j < config.ema.values.length; j++){
                                if(config.ema.values[j][i] == 0){
                                    datas.push(null);
                                }else{
                                    datas.push(config.ema.values[j][i]);
                                }
                            }
                        }

                        if(data['bbands'] != undefined){
                            if(config.bbands.up[i] == 0){
                                datas.push(null);
                            }else{
                                datas.push(config.bbands.up[i]);
                            }
                            if(config.bbands.mid[i] == 0){
                                datas.push(null);
                            }else{
                                datas.push(config.bbands.mid[i]);
                            }
                            if(config.bbands.down[i] == 0){
                                datas.push(null);
                            }else{
                                datas.push(config.bbands.down[i]);
                            }
                        }

                        if(data['events'] != undefined && data['events']['signals'] != undefined){
                            var event = config.events.first;
                            if(event == undefined){
                                datas.push(null);
                                datas.push(null);
                            } else if(event.time == candle.date_time){
                                // candle.high + 1ã€€ã¨ã™ã‚‹ã“ã¨ã§ã€SELL, BUYã®ã‚·ãƒ³ãƒœãƒ«ãŒã‚­ãƒ£ãƒ³ãƒ‰ãƒ«ã®å°‘ã—ä¸Šã§è¡¨ç¤ºã•ã›ã‚‰ã‚Œã‚‹
                                datas.push(candle.high + 1);
                                datas.push(event.side);
                                config.events.first = config.events.values.shift();
                            }else{
                                datas.push(null);
                                datas.push(null);
                            }
                        }

                        if(data['rsi'] != undefined){
                            datas.push(config.rsi.up);
                            if(config.rsi.values[i] == 0){
                                datas.push(null);
                            }else{
                                datas.push(config.rsi.values[i]);
                            }
                            datas.push(config.rsi.down);
                        }

                        googleChartData.push(datas);
                    }

                    dataTable.addRows(googleChartData);
                    drawChart(dataTable);
                })
            }


            function changeDuration(s){
                config.candlestick.duration = s;
                sendCandleData();
            }

            //setInterval(send, 1000*3)
            window.onload = function (){
                sendCandleData()
                //ã‚«ãƒ¼ã‚½ãƒ«ãŒãƒãƒ£ãƒ¼ãƒˆä¸Šã«ä¹—ã£ãŸå ´åˆã«enableãŒfalseã«ãªã‚‹
                //$('#dashboard_div').mouseenter(function() {
                    //config.api.enable = false;
                //}).mouseleave(function(){
                    //config.api.enable = true;
                //});

                // Smaã«é–¢ã™ã‚‹jquery
                $('#inputSma').change(function() {
                    config.sma.enable = this.checked;
                    sendCandleData();
                });

                $("#inputSmaPeriod1").change(function() {
                    config.sma.periods[0] = this.value;
                    sendCandleData();
                })
                $("#inputSmaPeriod2").change(function() {
                    config.sma.periods[1] = this.value;
                    sendCandleData();
                })
                $("#inputSmaPeriod3").change(function() {
                    config.sma.periods[2] = this.value;
                    sendCandleData();
                })

                // Emaã«é–¢ã™ã‚‹jquery
                $('#inputEma').change(function() {
                    config.ema.enable = this.checked;
                    sendCandleData();
                });

                $("#inputEmaPeriod1").change(function() {
                    config.ema.periods[0] = this.value;
                    sendCandleData();
                })
                $("#inputEmaPeriod2").change(function() {
                    config.ema.periods[1] = this.value;
                    sendCandleData();
                })
                $("#inputEmaPeriod3").change(function() {
                    config.ema.periods[2] = this.value;
                    sendCandleData();
                }) 

                $('#inputBBands').change(function() {
                    config.bbands.enable = this.checked;
                    sendCandleData();
                });

                $("#inputBBandsN").change(function() {
                    config.bbands.n = this.value;
                    sendCandleData();
                });

                $("#inputBBandsK").change(function() {
                    config.bbands.n = this.value;
                    sendCandleData();
                });
                //å‡ºæ¥é«˜ãƒãƒ£ãƒ¼ãƒˆã®è¡¨ç¤ºã®ãƒˆã‚°ãƒ«
                $("#inputVolume").change(function(){
                    if(this.checked){
                        config.volume.enable = true;
                        sendCandleData();
                    }
                    else{
                        config.volume.enable = false;
                        $('#volume_div').remove();
                    }
                })
                $("#inputRsi").change(function() {
                    if(this.checked){
                        config.rsi.enable = true;
                        sendCandleData();
                    }else{
                        config.rsi.enable = false;
                        $("#rsi_div").remove();
                    }

                });
                $("#inputRsiPeriod").change(function(){
                    config.rsi.period = this.value;
                    sendCandleData();
                });

                $("#inputEvents").change(function() {
                    if(this.checked){
                        config.events.enable = true;
                        sendCandleData();
                    }else{
                        config.events.enable = false;
                        $("#events_div").remove();
                    }

                });
                $("#inputEventsPeriod").change(function(){
                    config.events.period = this.value;
                    sendCandleData();
                });

                $("#input_ticker_keyword").change(function(){
                    if(this.value.length > 0) sendTickerKeyword(this.value);
                })

                //ãƒ†ã‚£ãƒƒã‚«ãƒ¼ãƒªã‚¹ãƒˆå†…ã®ãƒœã‚¿ãƒ³ã‚’æŠ¼ã—ãŸæ™‚ã«è¡¨ç¤ºã•ã‚Œã‚‹ãƒ¢ãƒ¼ãƒ€ãƒ«
                $(document).on("click", ".open-modal", function(){
                    let index = $(this).data("index");
                    let symbol = config.tickersBySearch[index]["1. symbol"]
                    let name = config.tickersBySearch[index]["2. name"];
                    $("#modal-content").html(`URL: <a href = "google.com">${name}</a>`);
                    $("#modal-content").append(
                        `<h3>Name: ${name}</h3`+
                        "<p>Look Details of this product</p>"+
                        `<button onclick='getTicker("${symbol}")'>Open Chart</button>`)
                    $("#myModal").show();
                });

                //ãƒ¢ãƒ¼ãƒ€ãƒ«ã®ã‚¯ãƒ­ãƒ¼ã‚º
                $(".close").click(function(){
                    $("#myModal").hide();
                });

            }
        </script>
    </head>
    <body>
        <div>
            <input type="text" id="input_ticker_keyword">
        </div>
        <ul id="ticker_list"></ul>
        <div id="myModal" class="modal">
            <div class="modal-content">
                <span class="close">&times;</span>
                <p id="modal-content">ã“ã“ã«URLãŒè¡¨ç¤ºã•ã‚Œã¾ã™</p>
            </div>
        </div>
        <div>
            <button onclick="changeDuration('day');">Day</button>
            <button onclick="changeDuration('week');">Week</button>
        </div>
        <div>
            SMA <input type="checkbox" id="inputSma">
            Period <input type="text" id="inputSmaPeriod1" value="7" style="...">
            <input type="text" id="inputSmaPeriod2" value="14" style="...">
            <input type="text" id="inputSmaPeriod3" value="50" style="...">
        </div>
        <div>
            EMA <input type="checkbox" id="inputEma">
            Period <input type="text" id="inputEmaPeriod1" value="7" style="...">
            <input type="text" id="inputEmaPeriod2" value="14" style="...">
            <input type="text" id="inputEmaPeriod3" value="50" style="...">
        </div>
        <div>
            BBands <input type="checkbox" id="inputBBands">
            N <input type="text" id="inputBBandsN" value="20" style="...">
            K <input type="text" id="inputBBandsK" value="2" style="...">
        </div>
        <div>
            Volume <input type="checkbox" id="inputVolume">
        </div>
        <div>
            Rsi <input type="checkbox" id="inputRsi">
            Period <input type="text" id="inputRsiPeriod" value="14" style="width: 15px;">
        </div>
        <div>
            Events <input type="checkbox" id="inputEvents"> <div id="profit"></div>
        </div>
        <div id="dashboard_div">
            <div id="chart_div"></div>
            <div id="technical_div"></div>
            <div id="filter_div"></div>
            <div id="events_div"></div>
            
        </div>
        
    </body>
</html>
